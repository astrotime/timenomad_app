{% assign excludeUrl=include.exclude.url %}
{% assign header=include.header %}

{% comment %}
<p>"{%- for post in site.posts -%}{{ post.url }}&nbsp;{%- endfor -%}"</p>
TODO: Add next story URL:
/posts/astrology/philosophy/2020/12/11/uncertainty-of-jupiter-saturn-conjunction-cycle.html 
{% endcomment %}

{% assign allUrls = "/posts/astrology/philosophy/2022/10/13/when-the-moon-nodes-turn-direct.html /posts/astrology/philosophy/2021/02/16/are-the-12-houses-ruled-by-the-zodiac-signs.html /posts/astrology/philosophy/2020/12/11/uncertainty-of-jupiter-saturn-conjunction-cycle.html /posts/astrology/philosophy/2020/10/21/first-and-second-saturn-returns.html /posts/astrology/event/2020/08/19/value-of-gold-in-the-time-of-saturn-pluto-conjunction.html /posts/astrology/event/2020/07/06/where-did-all-money-go-swallowed-by-jupiter-pluto-conjunction.html /posts/astrology/event/2020/06/04/american-karma-mars-and-neptune.html /posts/astrology/opinion/2020/05/17/deep-astrology-vs-astrology-lite.html /posts/astrology/philosophy/2019/07/31/the-shadow-of-the-black-moon.html /posts/astrology/philosophy/2019/07/15/myths-and-truths-behind-mercury-retrograde.html /posts/astrology/philosophy/2019/06/14/moon-nodes-and-force-of-destiny.html /posts/astrology/event/2018/12/22/saturn-pluto-conjunction-year-2019.html /posts/astrology/philosophy/2019/05/30/minor-aspects-domain-of-magic.html /posts/astrology/philosophy/2019/05/17/major-aspects-sacred-geometry.html /posts/astrology/event/2019/03/04/annual-sun-neptune-conjunction.html /posts/astrology/philosophy/2019/05/03/fixed-stars-in-astrology.html /posts/astrology/event/2019/04/15/influence-of-fixed-stars-case-of-notre-dame-fire.html /posts/astrology/philosophy/2019/03/23/sidereal-zodiac-in-astrology-its-strengths-and-weaknesses.html /posts/astrology/event/2019/03/14/timeline-of-saturn-pluto-conjunction-of-2020-and-its-karmic-meaning.html /posts/astrology/event/2019/02/05/mars-pluto-square-and-politics-of-nuclear-warfare.html /posts/astrology/interpretation/2019/01/28/love-triangle-of-jupiter-venus.html /posts/astrology/philosophy/2019/01/14/phases-of-moon-in-human-life.html /posts/astrology/philosophy/2019/01/01/seven-ages-of-man-and-woman.html /posts/astrology/philosophy/2018/12/17/finding-dominant-planet-using-heptagrams.html /posts/astrology/philosophy/2018/11/23/what-is-planetary-hours-part-one.html /posts/astrology/philosophy/2018/11/15/astrology-cycles-of-elements.html /posts/astrology/philosophy/2018/10/20/day-and-night-in-astrology.html /posts/astrology/event/2018/10/13/stocks-plunge-events-of-week.html /posts/astrology/philosophy/2018/10/05/how-classical-planets-rule-zodiac.html /posts/astrology/philosophy/2018/09/28/masculine-feminine-transgender-in-astrology.html" | split: " " %}

{% assign urls = "" | split: "" %}
{%- for url in allUrls -%}
	{% if url != excludeUrl %}
		{% assign urls = urls | push: url %}
	{% endif %}
{%- endfor -%}

{% case include.mode %} 
{% when 'featureAndPosts' %}

{% assign ftUri = '/documentation/planetary-hour-widget-and-alarm.html' %}
{% unless excludeUrl == ftUri %}

	{% assign ftUrl = site.url | append: ftUri %}
	{% assign ftTitle = 'NEW Planetary Hour widgets' %}
	{% assign ftBody = 'Add widgets to your home screen: **Planetary Hour** & **Weekday** + alarm.' %}

	{% assign ftImgs = "mars, venus, mercury, moon" | split: ", " %}
	{% assign ftImgSuffix = ftImgs | sample %}
	{% assign ftImg = "/images/promo/widget-planetary-hour-" | append: ftImgSuffix | append: '-promo.png' %}
	{% assign ftImgUrl = site.url | append: ftImg %}
	{% assign ftImgAlt = 'Planetary hour widget' %}

	<aside id="latest-news-related-posts" class="latest-news-related-posts">
		<div class="section group">
		  <div class="col span_6_of_12">
		  	<div class="box">
		  		<div class="news-thumb"><a href="{{ ftUrl }}"><img class="border-gray" src="{{ ftImgUrl }}" alt="{{ ftImgAlt }}"></a></div>
		  		<div class="news">
		  			<h2>{{ ftTitle }}</h2>
		  			<p>{{ ftBody | markdownify }} <a href="{{ ftUrl }}">Learn more…</a></p>
		  		</div>
		  	</div>
		  </div>
		  <div class="col span_6_of_12">
		  	<div class="posts">
		  		<h2>Featured stories you may like</h2>
		  	</div>
		  	<div class="box">
		  	{%- for idx in (0..3) -%}
				{% assign url = urls[idx] %}
				{% assign post = site.posts | where: "url", url | first %}
					<div class="post-thumb"><div><a href="{{ post.url | relative_url }}"><img class="border-gray" src="{{ post.schema.image_1x1.url }}" alt="{{ post.schema.images.alt }}"></a></div>
					<div><p class="line-clamp">{{ post.title }}</p><p class="act line-clamp"><a href="{{ post.url | relative_url }}">Read…</a></p></div>
					</div>
				{%- endfor -%}
		  	</div>
		  </div>
		</div>
	</aside>
{% endunless %}

{% when 'newsAndPosts' %}
{% assign nl = site.posts.first %}
{% assign nlUrl = site.url | append: nl.url %}
{% assign nlSchema = nl.schema %}

<aside id="latest-news-related-posts" class="latest-news-related-posts">
	<div class="section group">
	  <div class="col span_6_of_12">
	  	<div class="box">
	  		<div class="news-thumb"><a href="{{ nlUrl }}"><img class="border-gray" src="{{ nlSchema.image_1x1.url }}" alt="{{ nlSchema.images.alt }}"></a></div>
	  		<div class="news">
	  			<h2>{{ nl.title }}</h2>
	  			<p>{{ nl.app.description }}… <a href="{{ nlUrl }}">Read the story</a></p>
	  		</div>
	  	</div>
	  </div>
	  <div class="col span_6_of_12">
	  	<div class="posts">
	  		<h2>Featured stories you may like</h2>
	  	</div>
	  	<div class="box">
	  	{%- for idx in (1..4) -%}
			{% assign url = urls[idx] %}
			{% assign post = site.posts | where: "url", url | first %}
				<div class="post-thumb"><div><a href="{{ post.url | relative_url }}"><img class="border-gray" src="{{ post.schema.image_1x1.url }}" alt="{{ post.schema.images.alt }}"></a></div>
				<div><p class="line-clamp">{{ post.title }}</p><p class="act line-clamp"><a href="{{ post.url | relative_url }}">Read…</a></p></div>
				</div>
			{%- endfor -%}
	  	</div>
	  </div>
	</div>
</aside>

{% else %}
	<aside id="related-posts" class="related-posts">
		<h1>{{ header }}</h1>

		<div class="section group">
		{%- for idx in (0..2) -%}
			{% assign url = urls[idx] %}
			{% assign post = site.posts | where: "url", url | first %}
		  <div class="col span_4_of_12">
		  	<a href="{{ post.url | relative_url }}"><img loading="lazy" class="border-gray" src="{{ post.schema.image_1x1.url }}" alt="{{ post.schema.images.alt }}"></a>
			  <div>
			    <h2><a href="{{ post.url | relative_url }}">{{ post.title }}</a></h2>
			    <p>{{ post.description }}</p>
			  </div>
		  </div>
		{%- endfor -%}
		</div>

		<div class="section group">
		{%- for idx in (3..5) -%}
			{% assign url = urls[idx] %}
			{% assign post = site.posts | where: "url", url | first %}
		  <div class="col span_4_of_12">
		  	<a href="{{ post.url | relative_url }}"><img loading="lazy" class="border-gray" src="{{ post.schema.image_1x1.url }}" alt="{{ post.schema.images.alt }}"></a>
			  <div>
			    <h2><a href="{{ post.url | relative_url }}">{{ post.title }}</a></h2>
			    <p>{{ post.description }}</p>
			  </div>
		  </div>
		{%- endfor -%}
		</div>

		<h3><a href="/posts/">Alternatively, browse all available stories…</a></h3>
	</aside>
{% endcase %}